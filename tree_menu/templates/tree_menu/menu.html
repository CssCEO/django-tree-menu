{% load static %}
<ul class="menu">
    {% for item_data in menu_items %}
        <li class="menu-item{% if item_data.is_active %} active{% endif %}">
            <a href="{{ item_data.item.get_url }}">{{ item_data.item.name }}</a>
            {% if item_data.children and item_data.is_expanded %}
                <ul class="submenu">
                    {% for child_data in item_data.children %}
                        <li class="submenu-item{% if child_data.is_active %} active{% endif %}">
                            <a href="{{ child_data.item.get_url }}">{{ child_data.item.name }}</a>
                            {% if child_data.children and child_data.is_expanded %}
                                <ul class="submenu">
                                    {% for grandchild_data in child_data.children %}
                                        <li class="submenu-item{% if grandchild_data.is_active %} active{% endif %}">
                                            <a href="{{ grandchild_data.item.get_url }}">{{ grandchild_data.item.name }}</a>
                                        </li>
                                    {% endfor %}
                                </ul>
                            {% endif %}
                        </li>
                    {% endfor %}
                </ul>
            {% endif %}
        </li>
    {% endfor %}
</ul>